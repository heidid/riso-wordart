<!doctype html>
<html>
<head>
<title>riso wordart</title>
<link rel="stylesheet" href="styles.css" />
<body>

  <header>
    <h1>riso wordart!</h1>
    <p>a tiny project by Heidi Dong as a part of <a href="https://www.instagram.com/kellianderson/" target="_blank">@kellianderson</a>â€™s animation class at <a href="https://risolab.sva.edu/" target="_blank">SVA RisoLAB</a></p>
  </header>


<div id="container">

<div id="input-container">

<h2>input</h2>
<form>

<div class="field">
<label for="text-input">text</label>
<textarea name="text-input" id="text-input" autofocus autocapitalize="characters">HELLO</textarea>
</div>

<div class="field">
<label for="cyan-amount">cyan (aqua ink)</label>
<input type="range" name="cyan-amount" id="cyan-amount" min="0" max="1" step="0.01" />
</div>

<div class="field">
<label for="yellow-amount">yellow (yellow ink)</label>
<input type="range" name="yellow-amount" id="yellow-amount" min="0" max="1" step="0.01" />
</div>

<div class="field">
<label for="magenta-amount">magenta (bubblegum ink)</label>
<input type="range" name="magenta-amount" id="magenta-amount" min="0" max="1" step="0.01" />
</div>

<div class="field">
<label for="black-amount">black (black ink)</label>
<input type="range" name="black-amount" id="black-amount" min="0" max="1" step="0.01" />
</div>

<div class="field">
<label for="offset-amount">registration offset</label>
<input type="range" name="offset-amount" id="offset-amount" min="0" max="20" step="1" value="0" />
</div>

</form>

</div>

<div id="output-container">

<h2>output</h2>

<div id="output">
  <div id="cyan" class="color"></div>
  <div id="magenta" class="color"></div>
  <div id="yellow" class="color"></div>
  <div id="black" class="color"></div>
</div>

</div>
</div>

<script>
const textInput = document.getElementById('text-input');

const COLORS = ['cyan', 'magenta', 'yellow', 'black'];
const layerElements = COLORS.reduce((acc, cur) => ({
  ...acc,
  [cur]: document.getElementById(cur)
}), {});
const colorInputElements = COLORS.reduce((acc, cur) => ({
  ...acc,
  [cur]: document.getElementById(`${cur}-amount`)
}), {});
const offsetInput = document.getElementById('offset-amount');

const createCharacterElements = (color, char) => {
  const charElement = document.createElement('div');
  charElement.classList.add(`char-code-${char.charCodeAt(0)}`);
  charElement.classList.add('char');
  if (char !== ' ' && char >= 'A' && char <= 'Z') {
    charElement.classList.add(color);
  }
  return charElement;
}

const setColorInput = (color, value) => {
  layerElements[color].style.opacity = value;
}

const addChildrenToElement = (parent, listOfChildren) => {
  listOfChildren.forEach(element => {
    parent.appendChild(element);
  });
}

const generateOutput = (text) => {
  COLORS.forEach((color) => {
    const linesOfText = text.split('\n');
    const rowElements = linesOfText.map((line) => {
      const row = document.createElement('div');
      row.classList.add('row');
      const charElements = Array.from(line).map((char) =>
        createCharacterElements(color, char)
      )
      addChildrenToElement(row, charElements);
      return row;
    })

    layerElements[color].innerHTML = '';
    addChildrenToElement(layerElements[color], rowElements);
  })
}

textInput.oninput = (e) => {
  const text = e.target.value.toUpperCase();
  generateOutput(text);
};

for (const color of COLORS) {
  const initialValue = Math.random();
  colorInputElements[color].value = initialValue;
  setColorInput(color, initialValue);

  colorInputElements[color].oninput = (e) => {
    setColorInput(color, e.target.value);
  };
}

offsetInput.oninput = (e) => {
  const radius = e.target.value;
  for (const color of COLORS) {
    const degrees = Math.floor(Math.random() * 360);
    const radians = degrees * (Math.PI / 180);
    const xOffset = Math.cos(radians) * radius;
    const yOffset = Math.sin(radians) * radius;
    layerElements[color].style.left = `${xOffset}px`;
    layerElements[color].style.top = `${yOffset}px`;
  }
}

generateOutput(textInput.value);
</script>

</body>
</html>
